{"is_source_file": true, "format": "Python", "description": "This is the main application source file for a FastAPI-based backend API. It defines API endpoints for user authentication, user management, venue management, event handling, sustainability metrics, data submissions, and impact report generation. It also includes utility functions for JWT token creation, password verification, and role-based access controls.", "external_files": ["src.api.database", "src.api.models.orm_models", "src.api.models.pydantic_schemas"], "external_methods": ["get_db", "orm_models.User", "orm_models.Venue", "orm_models.Event", "orm_models.SustainabilityMetric", "orm_models.EventSustainabilityData", "orm_models.ImpactReport"], "published": ["health_check", "register_user", "login_token", "list_users", "get_my_user_info", "get_user", "delete_user", "create_venue", "list_venues", "get_venue", "update_venue", "delete_venue", "create_event", "list_events", "get_event", "update_event", "delete_event", "create_metric", "list_metrics", "submit_event_metric", "list_event_metrics", "create_impact_report", "list_impact_reports", "get_impact_report", "get_openapi_schema"], "classes": [], "methods": [{"name": "bool verify_password(plain_password: str, hashed_password: str)", "description": "Verifies a plaintext password against a hashed password.", "scope": "", "scopeKind": ""}, {"name": "str get_password_hash(password: str)", "description": "Hashes a plaintext password.", "scope": "", "scopeKind": ""}, {"name": "create_access_token(data: dict, expires_delta: Optional[timedelta] = None)", "description": "Creates a JWT access token with expiry.", "scope": "", "scopeKind": ""}, {"name": "get_user_by_email(db: Session, email: str)", "description": "Retrieves a user object from the database by email.", "scope": "", "scopeKind": ""}, {"name": "authenticate_user(db: Session, email: str, password: str)", "description": "Authenticates user credentials and returns user object if valid.", "scope": "", "scopeKind": ""}, {"name": "get_current_user(token: str = Depends(oauth2_scheme), db: Session = Depends(get_db))", "description": "Validates JWT token and fetches current user info.", "scope": "", "scopeKind": ""}, {"name": "require_admin(user: orm_models.User = Depends(get_current_user))", "description": "Ensures the current user has admin privileges.", "scope": "", "scopeKind": ""}, {"name": "create_event(event: EventCreate, db: Session = Depends(get_db), current_user: orm_models.User = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "create_impact_report(report_data: ImpactReportCreate, db: Session = Depends(get_db), current_user: orm_models.User = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "create_metric(metric: SustainabilityMetricCreate, db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "create_venue(venue: VenueCreate, db: Session = Depends(get_db), current_user: orm_models.User = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "delete_event(event_id: int, db: Session = Depends(get_db), current_user: orm_models.User = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "delete_user(user_id: int, db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "delete_venue(venue_id: int, db: Session = Depends(get_db), current_user: orm_models.User = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "get_event(event_id: int, db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "get_impact_report(report_id: int, db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "get_my_user_info(current_user: orm_models.User = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "get_openapi_schema()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "get_user(user_id: int, db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "get_venue(venue_id: int, db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "health_check()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list_event_metrics(event_id: Optional[int] = None, db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list_events(db: Session = Depends(get_db), venue_id: Optional[int] = None)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list_impact_reports(db: Session = Depends(get_db), event_id: Optional[int] = None)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list_metrics(db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list_users(db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list_venues(db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "login_token(form_data: OAuth2PasswordRequestForm = Depends(), db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "register_user(user_create: UserCreate, db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "submit_event_metric(data: EventSustainabilityDataCreate, db: Session = Depends(get_db), current_user: orm_models.User = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "update_event(event_id: int, event: EventCreate, db: Session = Depends(get_db), current_user: orm_models.User = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "update_venue(venue_id: int, venue: VenueCreate, db: Session = Depends(get_db), current_user: orm_models.User = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["verify_password", "get_password_hash", "create_access_token", "get_user_by_email", "authenticate_user", "get_current_user", "require_admin", "jwt.decode", "jwt.encode", "db.query", "db.add", "db.commit", "db.refresh", "db.delete"], "search-terms": ["FastAPI", "JWT_SECRET_KEY", "ImpactReportCreate", "create_impact_report", "ImpactReport", "sustainability metrics", "EventSustainabilityData", "ImpactReport", "get_db", "/auth/token", "/reports/", "openapi_tags"], "state": 2, "file_id": 3, "knowledge_revision": 35, "git_revision": "56718cf4c6de036774e30aa672ee46c3ee023523", "revision_history": [{"19": "bb593813a060886fdaed8f5d794394a699ff6f13"}, {"31": "bb593813a060886fdaed8f5d794394a699ff6f13"}, {"34": "db99506fee23bc0e726eb1ea0d9115e2c84048a5"}, {"35": "56718cf4c6de036774e30aa672ee46c3ee023523"}], "ctags": [{"_type": "tag", "name": "ALLOWED_ORIGINS", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^ALLOWED_ORIGINS = [$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "JWT_ACCESS_TOKEN_EXPIRE_MINUTES", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^JWT_ACCESS_TOKEN_EXPIRE_MINUTES = 120$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "JWT_ALGORITHM", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^JWT_ALGORITHM = \"HS256\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "JWT_SECRET_KEY", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^JWT_SECRET_KEY = os.getenv(\"JWT_SECRET_KEY\", \"dev-secret-key\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "authenticate_user", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def authenticate_user(db: Session, email: str, password: str):$/", "language": "Python", "kind": "function", "signature": "(db: Session, email: str, password: str)"}, {"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def create_access_token(data: dict, expires_delta: Optional[timedelta] = None):$/", "language": "Python", "kind": "function", "signature": "(data: dict, expires_delta: Optional[timedelta] = None)"}, {"_type": "tag", "name": "create_event", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def create_event(event: EventCreate, db: Session = Depends(get_db), current_user: orm_models.Use/", "language": "Python", "kind": "function", "signature": "(event: EventCreate, db: Session = Depends(get_db), current_user: orm_models.User = Depends(get_current_user))"}, {"_type": "tag", "name": "create_impact_report", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def create_impact_report(report_data: ImpactReportCreate, db: Session = Depends(get_db), current/", "language": "Python", "kind": "function", "signature": "(report_data: ImpactReportCreate, db: Session = Depends(get_db), current_user: orm_models.User = Depends(get_current_user))"}, {"_type": "tag", "name": "create_metric", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def create_metric(metric: SustainabilityMetricCreate, db: Session = Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(metric: SustainabilityMetricCreate, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "create_venue", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def create_venue(venue: VenueCreate, db: Session = Depends(get_db), current_user: orm_models.Use/", "language": "Python", "kind": "function", "signature": "(venue: VenueCreate, db: Session = Depends(get_db), current_user: orm_models.User = Depends(get_current_user))"}, {"_type": "tag", "name": "delete_event", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def delete_event(event_id: int, db: Session = Depends(get_db), current_user: orm_models.User = D/", "language": "Python", "kind": "function", "signature": "(event_id: int, db: Session = Depends(get_db), current_user: orm_models.User = Depends(get_current_user))"}, {"_type": "tag", "name": "delete_user", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def delete_user(user_id: int, db: Session = Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(user_id: int, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "delete_venue", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def delete_venue(venue_id: int, db: Session = Depends(get_db), current_user: orm_models.User = D/", "language": "Python", "kind": "function", "signature": "(venue_id: int, db: Session = Depends(get_db), current_user: orm_models.User = Depends(get_current_user))"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def get_current_user(token: str = Depends(oauth2_scheme), db: Session = Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(token: str = Depends(oauth2_scheme), db: Session = Depends(get_db))"}, {"_type": "tag", "name": "get_event", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def get_event(event_id: int, db: Session = Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(event_id: int, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "get_impact_report", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def get_impact_report(report_id: int, db: Session = Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(report_id: int, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "get_my_user_info", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def get_my_user_info(current_user: orm_models.User = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(current_user: orm_models.User = Depends(get_current_user))"}, {"_type": "tag", "name": "get_openapi_schema", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def get_openapi_schema():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_password_hash", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def get_password_hash(password: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(password: str)"}, {"_type": "tag", "name": "get_user", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def get_user(user_id: int, db: Session = Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(user_id: int, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "get_user_by_email", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def get_user_by_email(db: Session, email: str):$/", "language": "Python", "kind": "function", "signature": "(db: Session, email: str)"}, {"_type": "tag", "name": "get_venue", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def get_venue(venue_id: int, db: Session = Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(venue_id: int, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def health_check():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "list_event_metrics", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def list_event_metrics(event_id: Optional[int] = None, db: Session = Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(event_id: Optional[int] = None, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "list_events", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def list_events(db: Session = Depends(get_db), venue_id: Optional[int] = None):$/", "language": "Python", "kind": "function", "signature": "(db: Session = Depends(get_db), venue_id: Optional[int] = None)"}, {"_type": "tag", "name": "list_impact_reports", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def list_impact_reports(db: Session = Depends(get_db), event_id: Optional[int] = None):$/", "language": "Python", "kind": "function", "signature": "(db: Session = Depends(get_db), event_id: Optional[int] = None)"}, {"_type": "tag", "name": "list_metrics", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def list_metrics(db: Session = Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(db: Session = Depends(get_db))"}, {"_type": "tag", "name": "list_users", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def list_users(db: Session = Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(db: Session = Depends(get_db))"}, {"_type": "tag", "name": "list_venues", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def list_venues(db: Session = Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(db: Session = Depends(get_db))"}, {"_type": "tag", "name": "login_token", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def login_token(form_data: OAuth2PasswordRequestForm = Depends(), db: Session = Depends(get_db))/", "language": "Python", "kind": "function", "signature": "(form_data: OAuth2PasswordRequestForm = Depends(), db: Session = Depends(get_db))"}, {"_type": "tag", "name": "oauth2_scheme", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/token\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "pwd_context", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "register_user", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def register_user(user_create: UserCreate, db: Session = Depends(get_db)):$/", "language": "Python", "kind": "function", "signature": "(user_create: UserCreate, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "require_admin", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def require_admin(user: orm_models.User = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(user: orm_models.User = Depends(get_current_user))"}, {"_type": "tag", "name": "submit_event_metric", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def submit_event_metric(data: EventSustainabilityDataCreate, db: Session = Depends(get_db), curr/", "language": "Python", "kind": "function", "signature": "(data: EventSustainabilityDataCreate, db: Session = Depends(get_db), current_user: orm_models.User = Depends(get_current_user))"}, {"_type": "tag", "name": "update_event", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def update_event(event_id: int, event: EventCreate, db: Session = Depends(get_db), current_user:/", "language": "Python", "kind": "function", "signature": "(event_id: int, event: EventCreate, db: Session = Depends(get_db), current_user: orm_models.User = Depends(get_current_user))"}, {"_type": "tag", "name": "update_venue", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def update_venue(venue_id: int, venue: VenueCreate, db: Session = Depends(get_db), current_user:/", "language": "Python", "kind": "function", "signature": "(venue_id: int, venue: VenueCreate, db: Session = Depends(get_db), current_user: orm_models.User = Depends(get_current_user))"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/code-generation/event-impact-insights-4c5e6926/backend_api/src/api/main.py", "pattern": "/^def verify_password(plain_password: str, hashed_password: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(plain_password: str, hashed_password: str)"}], "hash": "99d4a5d94b93a6f06b726c916968295c", "format-version": 4, "code-base-name": "backend_api", "filename": "backend_api/src/api/main.py", "fields": [{"name": "ALLOWED_ORIGINS = [", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "JWT_ACCESS_TOKEN_EXPIRE_MINUTES = 120", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "JWT_ALGORITHM = \"HS256\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "JWT_SECRET_KEY = os.getenv(\"JWT_SECRET_KEY\", \"dev-secret-key\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/token\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")", "scope": "", "scopeKind": "", "description": "unavailable"}]}